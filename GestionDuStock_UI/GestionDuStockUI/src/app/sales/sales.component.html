<div class="sales-form">
  <form (ngSubmit)="createSale()">
    <!-- Sale Date Input -->
    <div>
      <label for="saleDate">Sale Date:</label>
      <input
        type="date"
        id="saleDate"
        [(ngModel)]="saleDate"
        name="saleDate"
        required
      />
    </div>

    <!-- Customer Selection Dropdown -->
    <div>
      <label for="customerId">Customer:</label>
      <select
        id="customerId"
        [(ngModel)]="selectedCustomerId"
        name="customerId"
        required
      >
        <option *ngFor="let customer of customers" [value]="customer.id">
          {{ customer.customerName }}
        </option>
      </select>
    </div>

    <!-- Product Selection -->
    <div>
      <label for="productSelect">Product:</label>
      <select
        id="productSelect"
        [(ngModel)]="selectedProductId"
        name="productSelect"
        (change)="onProductSelect()"
        required
      >
        <option value="">-- Select Product --</option>
        <option *ngFor="let product of products" [value]="product.id">
          {{ product.name }} - ${{ product.price }}
        </option>
        <option value="new">+ Add New Product</option>
      </select>
    </div>

    <!-- Product Details (For Selected or New Product) -->
    <div *ngIf="selectedProductId">
      <div>
        <label for="productName">Product Name:</label>
        <input
          type="text"
          id="productName"
          [(ngModel)]="newProduct.name"
          name="productName"
          [readonly]="selectedProductId !== 'new'"
          required
        />
      </div>

      <div>
        <label for="productPrice">Product Price ($):</label>
        <input
          type="number"
          id="productPrice"
          [(ngModel)]="newProduct.price"
          name="productPrice"
          [readonly]="selectedProductId !== 'new'"
          required
        />
      </div>

      <div>
        <label for="productQuantity">Quantity:</label>
        <input
          type="number"
          id="productQuantity"
          [(ngModel)]="newProduct.quantity"
          name="productQuantity"
          min="1"
          required
        />
      </div>

      <button type="button" (click)="addProductToSale()">Add to Sale</button>
    </div>

    <!-- List of Added Products -->
    <div>
      <h3>Sale List</h3>
      <ul>
        <li *ngFor="let item of newSaleData.sale.products">
          {{ item.product.name }} - ${{ item.product.price }} x {{ item.quantity }}
          <button type="button" (click)="removeProductFromSale(item.product)">Remove</button>
        </li>
      </ul>
    </div>

    <!-- Total Amount -->
    <div>
      <label for="totalAmount">Total Amount:</label>
      <input
        type="text"
        id="totalAmount"
        [value]="calculateTotalAmount()"
        readonly
      />
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      [disabled]="!saleDate || !selectedCustomerId || newSaleData.sale.products.length === 0"
    >
      Create Sale
    </button>
  </form>
</div>
