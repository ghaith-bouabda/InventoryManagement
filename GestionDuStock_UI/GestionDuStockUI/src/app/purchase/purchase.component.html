<div class="purchase-form">
  <form (ngSubmit)="createPurchase()">
    <!-- Purchase Date Input -->
    <div>
      <label for="purchaseDate">Purchase Date:</label>
      <input
        type="date"
        id="purchaseDate"
        [(ngModel)]="purchaseDate"
        name="purchaseDate"
        required
      />
    </div>

    <!-- Supplier Selection Dropdown -->
    <div>
      <label for="supplierId">Supplier:</label>
      <select
        id="supplierId"
        [(ngModel)]="selectedSupplierId"
        name="supplierId"
        required
      >
        <option *ngFor="let supplier of suppliers" [value]="supplier.id">
          {{ supplier.name }}
        </option>
      </select>
    </div>

    <!-- Product Selection -->
    <div>
      <label for="productSelect">Product:</label>
      <select
        id="productSelect"
        [(ngModel)]="selectedProductId"
        name="productSelect"
        (change)="onProductSelect()"
        required
      >
        <option value="">-- Select Product --</option>
        <option *ngFor="let product of products" [value]="product.id">
          {{ product.name }} - ${{ product.price }}
        </option>
        <option value="new">+ Add New Product</option>
      </select>
    </div>

    <!-- Product Details (For Selected or New Product) -->
    <div *ngIf="selectedProductId">
      <div>
        <label for="productName">Product Name:</label>
        <input
          type="text"
          id="productName"
          [(ngModel)]="newProduct.name"
          name="productName"
          [readonly]="selectedProductId !== 'new'"
          required
        />
      </div>

      <div>
        <label for="productPrice">Product Price ($):</label>
        <input
          type="number"
          id="productPrice"
          [(ngModel)]="newProduct.price"
          name="productPrice"
          [readonly]="selectedProductId !== 'new'"
          required
        />
      </div>

      <div>
        <label for="productQuantity">Quantity:</label>
        <input
          type="number"
          id="productQuantity"
          [(ngModel)]="newProduct.quantity"
          name="productQuantity"
          min="1"
          required
        />
      </div>

      <button type="button" (click)="addProductToPurchase()">Add to Purchase</button>
    </div>

    <!-- List of Added Products -->
    <div>
      <h3>Purchase List</h3>
      <ul>
        <li *ngFor="let item of newPurchaseData.purchase.products">
          {{ item.product.name }} - ${{ item.product.price }} x {{ item.quantity }}
          <button type="button" (click)="removeProductFromPurchase(item.product)">Remove</button>
        </li>
      </ul>
    </div>

    <!-- Total Amount -->
    <div>
      <label for="totalAmount">Total Amount:</label>
      <input
        type="text"
        id="totalAmount"
        [value]="calculateTotalAmount()"
        readonly
      />
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      [disabled]="!purchaseDate || !selectedSupplierId || newPurchaseData.purchase.products.length === 0"
    >
      Create Purchase
    </button>
  </form>
</div>
